# 🌟 تعليمات استخدام موقع ريحانة

## ✅ التحديثات المنجزة:

### 1. حل مشكلة تسجيل الخروج التلقائي
- ✅ **المشكلة**: كان الموقع يسجل خروج المستخدم عند عمل Refresh
- ✅ **الحل**: تم استخدام Firebase `onAuthStateChanged` للحفاظ على حالة تسجيل الدخول

### 2. أيقونة الملف الشخصي في الهيدر
- ✅ تم استبدال زر "تسجيل الخروج" بأيقونة دائرية جميلة تحمل أول حرف من اسم المستخدم
- ✅ عند النقر على الأيقونة، تظهر قائمة منسدلة تحتوي على:
  - الملف الشخصي
  - الإعدادات
  - تسجيل الخروج

### 3. صفحة الملف الشخصي
- ✅ صفحة جديدة `/profile` للمستخدم
- ✅ يمكن للمستخدم تعديل:
  - الاسم
  - البريد الإلكتروني
  - كلمة السر
- ✅ زر "نسيت كلمة السر؟" لإرسال رابط إعادة التعيين

### 4. دمج Supabase للبيانات
- ✅ **Firebase**: يُستخدم فقط للمصادقة (Authentication)
  - تسجيل الدخول
  - التسجيل
  - إعادة تعيين كلمة السر
  - نسيان كلمة السر
  
- ✅ **Supabase**: يُستخدم لتخزين جميع بيانات المستخدمين
  - الاسم
  - البريد الإلكتروني
  - رقم الهاتف
  - أي بيانات إضافية

### 5. تحديثات واجهة المستخدم
- ✅ شاشة تحميل جميلة عند فحص حالة المصادقة
- ✅ رسائل نجاح وخطأ واضحة في صفحة الملف الشخصي
- ✅ تصميم فاخر بألوان الذهبي الفخم
- ✅ انتقالات سلسة وأنيميشنز جميلة

## 📋 الخطوات المطلوبة من المستخدم:

### خطوة 1: إعداد Supabase
اتبع التعليمات في ملف `SUPABASE_SETUP.md`

الخطوات بإيجاز:
1. سجل في Supabase: https://supabase.com
2. أنشئ مشروع جديد
3. نفذ SQL commands لإنشاء جدول المستخدمين (موجود في الملف)
4. احصل على `Project URL` و `anon key`
5. أضفهم لملف `.env`

### خطوة 2: إنشاء ملف .env
أنشئ ملف `.env` في جذر المشروع:

```env
# Firebase Configuration
VITE_FIREBASE_API_KEY=AIzaSyBvem4m98qDEuVzg4XQP-MtwndE_buKnq4
VITE_FIREBASE_AUTH_DOMAIN=rihana-9e001.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=rihana-9e001
VITE_FIREBASE_STORAGE_BUCKET=rihana-9e001.firebasestorage.app
VITE_FIREBASE_MESSAGING_SENDER_ID=494667952255
VITE_FIREBASE_APP_ID=1:494667952255:web:8e661b7d2bd87b8a5e8f4a

# Supabase Configuration
VITE_SUPABASE_URL=your_supabase_url_here
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key_here
```

### خطوة 3: إعادة تشغيل السيرفر
```bash
# أوقف السيرفر (Ctrl+C)
# ثم شغله مرة أخرى
npm run dev
```

## 🎯 كيف يعمل النظام الآن:

### للمستخدمين الجدد:
1. يسجل في `/register`
2. البيانات تحفظ في:
   - Firebase Auth (للمصادقة)
   - Supabase (للبيانات الشخصية)
3. يتم توجيهه للصفحة الرئيسية تلقائياً

### للمستخدمين المسجلين:
1. يسجل دخول في `/login`
2. Firebase يتحقق من البيانات
3. App يجلب بيانات المستخدم من Supabase
4. يعرض اسم المستخدم في الهيدر

### الملف الشخصي:
1. المستخدم يضغط على أيقونة الملف الشخصي
2. يختار "الملف الشخصي" من القائمة
3. يمكنه تعديل:
   - الاسم (يحدث في Firebase + Supabase)
   - الإيميل (يحدث في Firebase + Supabase)
   - كلمة السر (يحدث في Firebase فقط)

## 🔧 الملفات المحدثة:

### ملفات جديدة:
- ✅ `src/config/supabase.js` - إعدادات وخدمات Supabase
- ✅ `src/pages/Profile.jsx` - صفحة الملف الشخصي
- ✅ `SUPABASE_SETUP.md` - تعليمات إعداد Supabase
- ✅ `تعليمات_الاستخدام.md` - هذا الملف

### ملفات محدثة:
- ✅ `src/App.jsx` - إضافة onAuthStateChanged وشاشة تحميل
- ✅ `src/components/Navbar.jsx` - أيقونة الملف الشخصي + dropdown menu
- ✅ `src/components/BottomNav.jsx` - تحديث زر الحساب
- ✅ `src/pages/Register.jsx` - الحفظ في Supabase بدلاً من Firestore
- ✅ `src/pages/Home.jsx` - استقبال بيانات المستخدم
- ✅ `src/index.css` - خط Amiri العربي الجميل

## 🎨 المميزات الجديدة:

### التصميم:
- 🎨 خط Amiri العربي الفخم
- 🎨 أيقونة ملف شخصي دائرية بألوان ذهبية
- 🎨 dropdown menu فاخر مع انتقالات سلسة
- 🎨 صفحة ملف شخصي بتصميم احترافي
- 🎨 رسائل نجاح/خطأ واضحة

### الوظائف:
- ⚡ الحفاظ على تسجيل الدخول بعد Refresh
- ⚡ تحديث البيانات بشكل لحظي
- ⚡ إدارة كاملة للملف الشخصي
- ⚡ Firebase للمصادقة + Supabase للبيانات
- ⚡ شاشة تحميل أثناء فحص حالة المصادقة

## ⚠️ ملاحظات مهمة:

1. **ملف .env**:
   - لا تشاركه مع أحد
   - أضف `.env` إلى `.gitignore`
   - الملف يحتوي على مفاتيح سرية

2. **Supabase**:
   - يجب إنشاء جدول `users` أولاً
   - استخدم SQL من ملف `SUPABASE_SETUP.md`
   - تأكد من تفعيل Row Level Security

3. **Firebase**:
   - يستخدم فقط للـ Authentication
   - لا يحفظ أي بيانات في Firestore الآن
   - كل البيانات في Supabase

## 🐛 في حالة وجود مشاكل:

### مشكلة: "Cannot connect to Supabase"
**الحل**: تأكد من:
- صحة `VITE_SUPABASE_URL` و `VITE_SUPABASE_ANON_KEY` في `.env`
- إعادة تشغيل السيرفر بعد تعديل `.env`

### مشكلة: "Failed to create user profile"
**الحل**: تأكد من:
- إنشاء جدول `users` في Supabase
- تشغيل SQL commands بنجاح
- صحة الأعمدة في الجدول

### مشكلة: "Authentication failed"
**الحل**: هذه مشكلة من Firebase:
- تأكد من صحة البريد وكلمة السر
- تأكد من أن Firebase مفعل في Console

## 📞 الدعم:

إذا واجهت أي مشكلة:
1. افحص Console المتصفح للأخطاء
2. تأكد من اتباع جميع الخطوات في `SUPABASE_SETUP.md`
3. تأكد من صحة ملف `.env`

---

**تم بحمد الله تنفيذ جميع المطالب! ✨**

الموقع الآن يستخدم:
- ✅ Firebase للمصادقة فقط
- ✅ Supabase لجميع البيانات
- ✅ أيقونة ملف شخصي جميلة
- ✅ صفحة ملف شخصي كاملة
- ✅ لا يسجل خروج عند Refresh
- ✅ خط Amiri العربي الفاخر

